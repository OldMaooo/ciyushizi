# 语文认字 - 需求调整（最终版）

## 核心流程确认

1. **预习** - 带拼音
2. **练习** - 不带拼音，标记不会的
3. **展示结果** - 错题集中显示，对的题隐藏
4. **错题练习** - 与「练习」一致
5. **正式测试** - 样式区分，但功能与「练习」一致，成绩会被单独记录

## 各页面修改点

### **1. 导航栏（navbar）**

**不变**

---

### **2. 首页（home）**

**修改：**
- 将原来的"开始练习"按钮改成三个按钮：
  - 「预习模式」按钮
  - 「练习模式」按钮
  - 「测试模式」按钮

**新增：**
- 无

---

### **3. 预习页面（新增页面：preview）**

**新增页面：**
- 复用 `practice` 页面的布局结构
- 顶部显示"预习模式"标识（badge）
- 顶部添加"显示拼音"开关（默认开启，可关闭）
- 卡片默认显示拼音
- 底部按钮："开始练习"（进入练习模式）、"跳过预习"（直接进入练习）

**复用：**
- 复用 `practice` 页面的翻页逻辑、卡片展示、导航按钮

---

### **4. 练习页面（practice）**

**新增：**
- 顶部添加"显示拼音"开关（form-switch，默认关闭）
- 顶部添加模式标识 badge（"练习模式"或"错题练习模式"）
- 根据"显示拼音"开关控制卡片是否显示拼音

**修改：**
- 卡片渲染逻辑：根据开关状态决定是否显示拼音（不依赖标记状态）
- 标记错题后仍显示拼音（如果开关开启）

**记忆策略：**
- 拼音开关状态全局记忆

---

### **5. 结果页面（results）**

**新增：**
- 顶部添加筛选/显示控制：
  - 默认只显示错题
  - 添加"显示全部"/"只显示错题"切换开关，并能始终记住这个设置状态
- 在统计区域添加模式标识（区分"练习结果"和"测试结果"）

**修改：**
- 卡片展示逻辑：默认只渲染错题卡片，对的题隐藏
- 统计信息保持不变

**记忆策略：**
- 筛选开关状态全局记忆

---

### **6. 错题集页面（errorbook）**

**新增：**
- 在"汇总查看"标签右侧增加「复习计划」标签
- 复习计划页面中，展示：
  - 本轮周期要练习的日期
  - 当前复习阶段（第X次复习）
  - 需要复习的错题
  - 最底下显示「开始练习」、「开始测试」按钮
- 错题卡片上方显示状态信息：
  - 本轮练习：已完成/未完成
  - 本轮测试：已完成/未完成
- 练习不一定要做，但是测试一定要完成，否则就会一直显示未完成状态
- 如果测试完成了，错题卡片消失，整个状态显示已完成，并显示下个周期的错题，可以练习，但是「开始测试」按钮置灰，不可以用
- 卡片显示阶段，但不要用文字，尽量图形化，比如用特殊符号来表示实心块和空心块来表示进度、阶段

**修改：**
- 无（错题练习功能已存在，保持现状）

---

### **7. 正式测试页面（复用 practice 页面，通过模式区分）**

**新增：**
- 顶部添加"正式测试模式"标识（badge，样式区分，如红色边框或特殊颜色）
- 顶部显示"测试模式，拼音已锁定"提示（拼音开关禁用状态）
- 测试完成后，结果页显示"测试结果"标识（与练习结果区分）

**修改：**
- 复用 `practice` 页面，通过 `mode` 参数区分
- 测试模式下，拼音开关强制关闭且不可操作
- 测试结果单独存储，标记 `isOfficialTest: true`

**入口：**
- 从错题集"复习计划"标签中的"开始测试"按钮进入
- 测试来源：复习计划中的词

---

### **8. 结果页面（results）- 测试结果特殊处理**

**新增：**
- 测试结果模式下，顶部显示"正式测试结果"标识

**修改：**
- 根据 `mode` 显示不同的标题和标识

---

## 数据模型扩展

### 练习记录扩展
```javascript
{
  id: "round_xxx",
  date: "2025-01-XX",
  mode: "preview" | "practice" | "error-practice" | "test",  // 新增：模式区分
  type: "self" | "parent",    // 新增：自主练习 vs 家长测试
  totalWords: 20,
  correctCount: 18,
  errorCount: 2,
  accuracy: 90,
  duration: 300,
  showPinyin: false,          // 新增：是否显示拼音
  groups: [...],
  // 如果是测试模式
  isOfficialTest: true,       // 新增：是否正式测试
  reviewPlanId: "plan_xxx"    // 新增：关联的复习计划ID（如果是复习测试）
}
```

### 错题记录扩展
```javascript
{
  id: "error_xxx",
  wordId: "word_xxx",
  word: "山坡",
  pinyin: "shān pō",
  unit: "第一单元",
  markedInMode: "practice" | "test",  // 在哪个模式下标记的
  markedBy: "self" | "parent",         // 谁标记的
  practiceRoundId: "round_xxx",        // 关联的练习轮次
  testRoundId: "round_xxx",            // 关联的测试轮次
  markedAt: "2025-01-XX",
  // 复习计划相关
  reviewPlan: {
    firstMarkedAt: "2025-01-15 10:00",
    stages: [
      { stage: 1, scheduledAt: "2025-01-15 11:00", completedAt: null, status: "pending" },
      { stage: 2, scheduledAt: "2025-01-16 10:00", completedAt: null, status: "pending" },
      // ... 6个阶段
    ],
    currentStage: 1,
    mastered: false
  }
}
```

---

## 复习计划逻辑

### 时间节点（艾宾浩斯曲线）
- 首次标记后：1小时后、1天后、3天后、1周后、2周后、1个月后

### 状态判断
- **本轮**：按复习计划的阶段判断
- **已完成**：该阶段的测试已完成
- **未完成**：该阶段的测试未完成
- **已掌握**：所有阶段通过或手动标记为已掌握

### 图形化显示
- 使用实心块（●）和空心块（○）表示进度
- 例如：●●○○○○ 表示已完成2个阶段，还有4个阶段待完成

---

## 记忆策略

所有设置类的开关、参数设置都按**全局记忆**：
- 拼音开关状态
- 结果页筛选开关状态
- 题目数量、速度、每页词语数量等设置

---

*最后更新：2025-01-XX*

